library(tidyverse)
library(tidytext)
library(textreadr)
libray(qdap)
library(qdap)
unnamed<-read_docx("F:/Kasturi/Unnamed.docx")
unnamed<-replace_contraction(unnamed)
unnamed<-data_frame(unnamed)
unnamed[10:15,1]
unnamed<-read_docx("F:/Kasturi/Unnamed.docx")
unnamed[400:450]
unnamed[400]
unnamed[405]
str(unnamed)
replace_contraction(unnamed[448])
replace_contraction(as.character(unnamed[448]))
replace_contraction("She's the one who's been acting weird")
replace_contraction(""She's the one who's been acting weird"")
replace_contraction(as.character(unnamed[108]))
replace_contraction(as.character(unnamed[1080]))
a<-unnamed[1080]
b<-"theyre"
b<-"they're"
replace_contraction(b)
replace_contraction(a)
unnamed<-data_frame(unnamed)
str(unnamed)
replace_contraction(unnamed[1080, 1])
replace_contraction(unnamed[3, 1])
replace_contraction(as.character(unnamed[3, 1])
)
unnamed<-unnest_tokens(unnamed, words, unnamed)
str(unnamed)
unnamed[450:460, 1]
unnamed<-read_docx("F:/Kasturi/Unnamed.docx")
unnamed<-unnest_tokens(unnamed, lines, unnamed)
unnamed<-data_frame(unnamed)
unnamed<-unnest_tokens(unnamed, lines, unnamed)
unnamed[1080, 1]
str(unnamed)
unnamed<-read_docx("F:/Kasturi/Unnamed.docx")
unnamed<-unnest_tokens(unnamed, sentences, unnamed)
unnamed<-data_frame(unnamed)
a<-unnamed
a<-unnest_tokens(a, sentences, a)
str(a)
a<-unnest_tokens(a, sentences, unnamed)
str(a)
a<-unnamed
a<-unnest_tokens(a, token=sentences, unnamed)
a<-unnest_tokens(a, token='sentences', unnamed)
a<-unnamed
a<-unnest_tokens(a, input=unnamed, token=sentences)
str(a)
a<-unnest_tokens(a, words, unnamed)
sapply(a, replace_contraction)
a<-sapply(a, replace_contraction)
a[450:470,]
a[450:500,]
str(unnamed)
a<-unnamed[1080]
a<-unnamed[1080,]
a
sapply(a, replace_contraction)
a[2,1]<-"There's definitely been some issues"
sapply(a, replace_contraction)
gsub("“", "", a)
b<-gsub("“", "", a)
replace_contraction(b)
b<-gsub("”", "", a)
b<-gsub("“", "", b)
b
replace_contraction(b)
a<-unnamed
str(a)
a[3:4]
a[3:4,]
a[3,]
unnamed<-read_docx("F:/Kasturi/Unnamed.docx")
unnameddf<-data.frame(unnamed)
str(unnameddf)
unnameddf<-data.frame(unnamed, as.factor=FALSE)
str(unnameddf)
unnameddf<-data.frame(unnamed)
unnameddf[1080,]
replace_contractions(unnameddf[1080,])
replace_contraction(unnameddf[1080,])
a<-unnameddf[1080,]
str_replace_all(a, "“","")
str_replace_all(a, "[“”]","")
a<-str_replace_all(a, "[“”]","")
a
replace_contraction(a)
replace_contraction(a[30:40])
b<-"i'm"
replace_contraction(b)
b<-a
replace_contraction(b)
rm(b)
a<-as.character(a)
replace_contraction(a)
a<-data_frame(a)
str(a)
sapply(a, replace_contraction)
unnest_tokens(a, words, a)
anti_join(a, stop_words)
colnames(a)<-c("word")
anti_join(a, stop_words)
a<-anti_join(a, stop_words)
a<-unnest_tokens(a, words, a)
a<-unnest_tokens(a, words, word)
a<-anti_join(a, stop_words)
a<-anti_join(a, stop_words, by="word")
colnames(a)<-c("words")
a<-anti_join(a, stop_words)
a<-anti_join(a, stop_words, by="word")
a<-anti_join(a, stop_words, by=word)
a
data("stop_words")
data(stop_words)
a<-anti_join(a, stop_words, by=word)
colnames(a)<-c("word")
a<-anti_join(a, stop_words, by=word)
str(A)
str(a)
a<-anti_join(a, stop_words,)
a<-anti_join(a, stop_words)
a
stop_words
a<-unnameddf[1080,]
a<-unnest_tokens(a, words, unnameddf)
str(a)
a<-unnamed[1080]
a<-unnest_tokens(a, words, unnamed)
a<-data.frame(a)
a<-unnest_tokens(a, words, unnamed)
str(a)
a<-unnest_tokens(a, words, a)
a<-unnamed[1080]
a<-data_frame(a)
str(a)
unnest_tokens(a, words, a)
b<-unnest_tokens(a, words, a)
colnames(b)<-"word"
anti_join(b, stop_words)
sapply(b, replace_contraction)
b
sapply(a, str_replace_all, [’], "'" )
sapply(a, str_replace_all, "’", "'" )
b<-sapply(a, str_replace_all, "’", "'" )
replace_contraction(b)
b<-data_frame(b)
str(b)
colnames(b)<-"word"
anti_join(b, stop_words)
b<-unnest_tokens(b, words, word)
anti_join(b, stop_words)
str(b)
colnames(b)<-"word"
anti_join(b, stop_words)
str(unnameddf)
unnameddf<-data_frame(unnamed)
str(unnameddf)
unnameddf[1080,]
unnamed_df<-sapply(unnameddf, str_replace_all, "[“”’‘]", "[""'']")
unnamed_df<-sapply(unnameddf, str_replace_all, "[“”]", """)
)
e
""
unnamed_df<-sapply(unnameddf, str_replace_all, "[“”]", "["]")
unnamed_df<-sapply(unnameddf, str_replace_all, "[“”]", "\"")
unnamed_df<-sapply(unnamed_df, str_replace_all, "[’‘]", "/'")
str(unnamed_df)
unnamed_df<-data_frame(unnamed_df)
unnamed_df<-sapply(unnamed_df, str_replace_all, "[’‘]", "/'")
str(unnamed_df)
unnamed_df[1080,]
unnamed_df<-sapply(unnameddf, str_replace_all, "[“”]", "\"")
unnamed_df<-sapply(unnamed_df, str_replace_all, "[’‘]", "\'")
str(unnamed_df)
unnamed_df<-data_frame(unnamed_df)
unnamed_df<-sapply(unnamed_df, str_replace_all, "[’‘]", "\'")
str(unnamed_df)
unnamed_df[1080,]
unnamed_df<-data_frame(unnamed_df)
unnamed_df<-data_frame(unnamed_df[,1])
View(unnamed_df)
colnames(unnamed_df)<-"text"
unnamed_words<-unnest_tokens(unnamed_df, words, text)
colnames(unnamed_words)<-"word"
c<-anti_join(unnamed_words, stop_words)
count(c, word, sort=TRUE)
unnamed_words_ns<-anti_join(unnamed_words, stop_words)
count(unnamed_words_ns, word, sort=TRUE)
c<-count(unnamed_words_ns, word, sort=TRUE)
c[11:20,]
c[21:30,]
c%>%ggplot(aes(x=word, y=n))+geom_bar()+coord_flip()
c%>%ggplot(aes(x=word, y=n))+geom_bar()
c[1:100,]%>%ggplot(aes(x=n, y=word))+geom_bar()
c[1:100,]%>%ggplot(aes(x=n, y=word))+geom_bar(stat='identity')
c[1:50,]%>%ggplot(aes(x=word, y=n))+geom_bar(stat='identity')+coord_flip()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n))+geom_bar(stat='identity')+coord_flip()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n))+geom_bar(stat='identity')+coord_flip()+theme(text=element_text(size=10))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n))+geom_bar(stat='identity')+coord_flip()+theme(text=element_text(size=8))
windows()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n))+geom_bar(stat='identity')+coord_flip()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(low=#000, high=#777)
)
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(low="#000", high="#777")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(low="#000000", high="#777777")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#000000", low="#555555")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#000000", low="#404040")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#9f0000", low="#5f0000")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f0000", low="#7f0000")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f0000", low="#bf0000")
windows()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f0020", low="#bf0020")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#bf1020")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#9f1020")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#9f0510")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#ffffff")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#af50a0")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#cc7070")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#cca070")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#cc9050")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#ccb050")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#ccb010")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#acb050")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#00ff00", low="#ff0000")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#cca070")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#dc9070")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#dc9070")+xlab(NULL)+ylab("Frequency")
wordcloud(c$word, c$n)
library(wordcloud)
wordcloud(c$word, c$n, max.words=max.words = 100 )
wordcloud(c$word, c$n, max.words=100)
warnings()
windows()
wordcloud(c$word, c$n, max.words=100)
library(RColorBrewer)
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values=brewer.pal(50,"YlOrRd"))+xlab(NULL)+ylab("Frequency")
windows()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values=brewer.pal("YlOrRd"))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values=colorRampPalette(brewer.pal("YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values=colorRampPalette(brewer.pal(50,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values=colorRampPalette(brewer.pal("YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_brewer(palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_scale_brewer(palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_brewer(palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_color_brewer(palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_color_brewer(palette = "YlOrRd", direction=-1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_color_brewer(type="seq", palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_brewer(type="seq", palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_brewer(type="seq", palette = 1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_color_brewer(type="seq", palette = 1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal("YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(50,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(8,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(values=colorRampPalette(brewer.pal(8,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(colours =colorRampPalette(brewer.pal(8,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(colours =(brewer.pal(8,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(colours =rev(brewer.pal(11,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(colours =rev(brewer.pal(9,"YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(colorRampPalette(rev(brewer.pal(11, "Spectral"))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_colour_gradientn(colours=colorRampPalette(rev(brewer.pal(11, "Spectral"))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_color_distiller(palette = "YlOrRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_color_distiller(palette = "RdPu")+xlab(NULL)+ylab("Frequency")
display.brewer.all()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal("YlOrRd")))+xlab(NULL)+ylab("Frequency")
)
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal("YlOrRd")))+xlab(NULL)+ylab("Frequency")
windows()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal("YlOrRd")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal("RdPu")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(colourCount))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(colourCount))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(length(unique(n))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(length(n))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(length(n))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, colours()=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(length(n))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, colour=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(length(n))+xlab(NULL)+ylab("Frequency")
)
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, colour=(n)))+geom_bar(stat='identity')+coord_flip()+scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n)))+xlab(NULL)+ylab("Frequency")
)
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, colour=(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=colorRampPalette(brewer.pal(9,"RdPu"))))+
geom_bar(stat='identity')+
coord_flip()+
scale_colour_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_fill_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_fill_manual(values=colorRampPalette(brewer.pal(9,"RdPu")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_fill_manual(values=colorRampPalette(brewer.pal(9,"RdPu")))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_fill_manual(values=colorRampPalette(brewer.pal(9,"RdPu"))(length(n)))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+
geom_bar(stat='identity')+
coord_flip()+
scale_fill_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n))))+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%
ggplot(aes(x=reorder(word, n), y=n, fill=factor(n)))+
geom_bar(stat='identity')+
scale_fill_manual(values=colorRampPalette(brewer.pal(9,"RdPu")(length(n))))
c[1:50,]%>%
library(tidyverse)
library(tidytext)
library(textreadr)
library(qdap)
library(RColorBrewer)
library(wordcloud)
str(unnamed_words_ns)
str(c)
windows()
wordcloud(c$word, c$n, max.words = 100,colors=brewer.pal(8, "Dark2"))
wordcloud(c$word, c$n, max.words = 100,colors=brewer.pal(8, "YlOrRd"))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(8, "YlOrRd"))(100))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal("YlOrRd"))(100))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"YlOrRd"))(100))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"YlOrRd"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"PuRd"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(12,"RdBu"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(11,"RdBu"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(11,"RdBu"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(10,"Purples"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Purples"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Purples"))(20))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Purples"))(100))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Purples"))(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"GnBu"))(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Blues"))(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Blues"))(length(unique(c$n))))+par(bg="#333")
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Blues"))(length(unique(c$n))))+par(bg="#333333")
par(bg="#333333")
par(bg="black")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradient(high="#1f1020", low="#dc9070")+xlab(NULL)+ylab("Frequency")
wordcloud2(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Purples"), backgroundColor="#333333")(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Purples"), backgroundColor="#333333")(length(unique(c$n))))
windows()
dev.off()
windows()
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(12,"Paired"))(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"Dark2"))(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(brewer.pal(9,"PuRd"))(length(unique(c$n))))
palettePuRd<-brewer.pal(9, "PuRd")
palettePuRd<-palettePuRd[-1:2]
palettePuRd<-palettePuRd[-(1:2)]
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(palettePuRd(length(unique(c$n))))
)
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette((palettePuRd)(length(unique(c$n))))
)
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette((palettePuRd)(length(unique(c$n)))))
wordcloud(c$word, c$n, max.words = 100,colors=palettePuRd)
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(palettePuRd)(100))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(palettePuRd)(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100,colors=colorRampPalette(palettePuRd)(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100, random.order = FALSE,colors=colorRampPalette(palettePuRd)(length(unique(c$n))))
wordcloud(c$word, c$n, max.words = 100, random.order = FALSE,colors=colorRampPalette(palettePuRd)(length(unique(c$n[1:100]))))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = palettePuRd)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "PuRd")+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "PuRd", direction = -1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "PuRd", direction = 1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "YlOrRd", direction = 1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "YlOrRd", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(plot.background = element_rect(fill="#333333"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "YlOrRd", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#333333"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "palettePuRd", direction = 1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = palettePuRd, direction = 1)+xlab(NULL)+ylab("Frequency")
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "YlOrRd", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(plot.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "YlOrRd", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(plot.panel = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "YlOrRd", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "PuRd", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "GnBu", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "Purples", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(colors = palettePuRd, direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(colors = colorRampPalette(palettePuRd(50)), direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(colors = colorRampPalette(palettePuRd)(50), direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values = colorRampPalette(palettePuRd)(50), direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values = colorRampPalette(palettePuRd)(50))+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=factor(n), fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_manual(values = colorRampPalette(palettePuRd)(50))+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "Reds", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "Reds", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#dedede"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = "Reds", direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#eeeeee"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = brewer.pal(7,palettePuRd), direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_distiller(palette = brewer_pal(7,palettePuRd), direction = 1)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(palette = colours=palettePuRd)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=palettePuRd)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
customPuRd<-palettePuRd
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customPuRd)+xlab(NULL)+ylab("Frequency")+theme(panel.background = element_rect(fill="#ffffff"))
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customPuRd)+xlab(NULL)+ylab("Frequency")+theme_classic()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customPuRd)+xlab(NULL)+ylab("Frequency")+theme_minimal()
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customPuRd)+xlab(NULL)+ylab("Frequency")+theme_minimal(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customPuRd)+xlab(NULL)+ylab("Frequency")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
customYlOrRd<-brewer.pal(9, "YlOrRd")
customYlOrRd<-customYlOrRd[-(1:3)]
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customYlOrRd)+xlab(NULL)+ylab("Frequency")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
customYlOrRd<-brewer.pal(9, "YlOrRd")
customYlOrRd<-customYlOrRd[-(1:2)]
c[1:50,]%>%ggplot(aes(x=reorder(word, n), y=n, fill=n))+geom_bar(stat='identity')+coord_flip()+scale_fill_gradientn(colours=customYlOrRd)+xlab(NULL)+ylab("Frequency")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
library(tidyverse)
library(tidytext)
library(textreadr)
library(qdap)
library(RColorBrewer)
library(wordcloud)
library(ggraph)
library(igraph)
library(widyr)
unnamed_ngrams<-unnest_tokens(unnamed_df, bigram, text, token='ngrams', n=2)
c_ngram<-count(unnamed_ngrams, bigram, sort=TRUE)
split_c_ngram<-separate(c_ngram, bigram, c("word1", "word2"), sep = " ")
split_c_ngram_ns<- split_c_ngram%>%
filter(!word1 %in% stop_words$word) %>%
filter(!word2 %in% stop_words$word)
c_ngram_ns<- unite(split_c_ngram_ns, bigram, word1, word2, sep = " ")
bigram_graph_ns<-split_c_ngram_ns%>%
filter(n>=5) %>%
graph_from_data_frame()
windows()
ggraph(bigram_graph_ns, layout = "fr") +geom_edge_link() +geom_node_point() +geom_node_text(aes(label = name), vjust = 1, hjust = 1) #simple, no colours or arrows
ggraph(bigram_graph_ns, layout = "fr") +
geom_edge_link(aes(edge_alpha = n), show.legend = FALSE,
arrow = grid::arrow(type = "closed", length = unit(.15, "inches")), end_cap = circle(.07, 'inches')) +
geom_node_point(color = "lightblue", size = 5) +
geom_node_text(aes(label = name), vjust = 1, hjust = 1) +
theme_void()
bigram_graph<-split_c_ngram[1:50,]%>%
graph_from_data_frame()
ggraph(bigram_graph, layout = "fr") +
geom_edge_link(aes(edge_alpha = n), show.legend = FALSE,arrow = grid::arrow(type = "closed", length = unit(.15, "inches")), end_cap = circle(.07, 'inches'))+
geom_node_point(color = "lightblue", size = 5) +
geom_node_text(aes(label = name), vjust = 1, hjust = 1) +
theme_void()
unnamed_sentences<-unnest_tokens(unnamed_df, s, text, token = "sentences")
unnamed_sentences$sentence<-c(1:length(unnamed_sentences$s))
unnamed_sentences<-unnest_tokens(unnamed_sentences, word, s, token="words")
unnamed_sentences_ns<-unnamed_sentences%>%filter(!word %in% stop_words$word)
unnamed_section_ns<-unnamed_sentences_ns
unnamed_section_ns$sentence<-unnamed_section_ns$sentence%/%4 #taking four sentences as one section
pairwise_count(unnamed_section_ns,word, sentence, sort=TRUE)
unnamed_section_ns%>%group_by(word)%>%filter(n()>20)%>%pairwise_cor(word, sentence, sort=TRUE)
section_cor<-unnamed_section_ns%>%group_by(word)%>%filter(n()>20)%>%pairwise_cor(word, sentence, sort=TRUE)
section_cor%>%
filter(correlation > .1) %>%
graph_from_data_frame() %>%
ggraph(layout = "fr") +
geom_edge_link(aes(edge_alpha = correlation), colour="#ef5b7f", show.legend = FALSE) +
geom_node_point(color = "#5befcb", size = 2) +
geom_node_text(aes(label = name), colour="#dddddd",repel = TRUE, size=3.2, vjust=1) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_rect(fill="#222222"), panel.border = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(), axis.line=element_blank(), axis.text.x=element_blank(), axis.text.y=element_blank(),axis.ticks=element_blank(),) #correlation graph without external borders or axes
